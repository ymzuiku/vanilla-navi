!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("querystring-number")):"function"==typeof define&&define.amd?define(["querystring-number"],n):(t=t||self).vanillaNavi=n(t.queryString)}(this,function(o){"use strict";o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var r={initData:null,routers:{},division:"#",paths:[],rootElement:document.createElement("div"),navis:{},listenFunctions:{},listenFunctionKey:0};function s(t,n){if(void 0!==r.routers[t]){var e,i="";i=n?(e=r.routers[t](n),""+r.division+t+"?"+o.stringify(n)):(e=r.routers[t](),""+r.division+t),window.history.pushState(null,"",i),a(),r.paths.push({path:t,params:n}),e.setAttribute("data-navi-path",i),r.rootElement.append(e)}else s(r.initData.path,r.initData.params)}r.rootElement.style.width="100%",r.rootElement.style.height="100%",r.rootElement.id="navi-root";function l(){var t={title:"",url:""};window.history.pushState(t,t.title,t.url)}function a(){Object.keys(r.listenFunctions).forEach(function(t){(0,r.listenFunctions[Number(t)])({path:r.paths[r.paths.length-1].path,params:r.paths[r.paths.length-1].params})})}function u(){var t=window.location.hash;if((t=t.replace(r.division,""))&&-1<=t.indexOf("?")){var n=t.split("?");return[n[0],o.parse(n[1])]}return[t,void 0]}var p={root:r.rootElement,canPop:function(){return!!r.rootElement.lastChild},push:s,pop:function(){if(r.rootElement.lastChild){var t=r.rootElement.lastChild._naviBeforePop;a(),r.paths.pop(),window.history.back(),t?(t.event(),setTimeout(function(){r.rootElement.lastChild&&r.rootElement.removeChild(r.rootElement.lastChild)},t.duration)):r.rootElement.removeChild(r.rootElement.lastChild)}else console.warn("vanilla-navi: no have child elements")},listen:function(t){var n=r.listenFunctionKey++;return r.listenFunctions[n]=t,function(){delete r.listenFunctions[n]}},detail:r,use:function(t,n){r.routers[t]=n,console.log(r.routers)},init:function(t,n){r.initData||(r.initData={path:t,params:n});var e,i,o=window.location.hash;if(l(),o){var a=u();e=a[0],i=a[1]}s(t,n),e&&JSON.stringify({path:t,params:n})!==JSON.stringify({path:e,params:i})&&s(e,i)},getPathAndParams:u,clearHistory:l};return"undefined"!=typeof window&&window.addEventListener("popstate",function(t){for(var n=!1,e=0;e<r.paths.length;e++){if(r.paths[e].path===window.location.hash){n=!0;break}}if(console.log("=-===",n,r.initData),!n){var i=u(),o=i[0],a=i[1];r.routers[o]?p.init(o,a):p.init(r.initData.path,r.initData.params)}console.log("=-===",n,r.initData)}),p});
//# sourceMappingURL=index.js.map
